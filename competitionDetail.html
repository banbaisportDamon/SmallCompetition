<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
  	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
		
    <script src="js/mui.min.js"></script>
    <link href="css/mui.min.css" rel="stylesheet"/>
    <link href="css/mui.picker.min.css" rel="stylesheet" />
	<link href="css/mui.poppicker.css" rel="stylesheet" />
    <link href="css/base.css" rel="stylesheet"/>
    <!--
    <script type="text/javascript" charset="utf-8">
      	mui.init();
    </script>-->
    <style>
    		* {color: #323a45;}
    		header.mui-bar.mui-bar-nav {background-color: #18b4ed;}
    		header.mui-bar.mui-bar-nav a{color:#fff;}
    		header.mui-bar.mui-bar-nav span{color:#fff; height:1.6em}
    		header.mui-bar.mui-bar-nav h1 {color:#fff;}
    		header {
    			box-shadow: none;
    			-webkit-box-shadow:none;
    		}

		.mui-content table .left {
			background: url(img/VS_background_01.png);
		}
		.mui-content table .score {
			width: 120px;
			background: url(img/VS_background_02.png);
			background-position: center;
			background-size: 120px 120px;
			color: #fff;
		}
		.mui-content table .right {
			background: url(img/VS_background_03.png);
		}
		.mui-content td span {display: inline-block;}
		
		.competition {
    			padding: 15px 5px;
    			background-color: #fff;
    			margin-bottom: 20px;
    			border-radius: 2%;
    			box-shadow: 5px 5px 5px #888888;
    		}
		.competition td.typebackground {
			background: url(img/typebackground.png);
			background-repeat: no-repeat;
			background-position: center;
			background-size: 40px 35px;
			color:#fff;
		}
		hr {border: 0.5px solid #ccc;}
		
    </style>
</head>
<body>
	<header class="mui-navbar-inner mui-bar mui-bar-nav">
		<a class="mui-icon mui-icon-left-nav mui-pull-left" href="#"></a>
		<span id="createGame" class="mui-action-menu mui-icon mui-icon-plusempty mui-pull-right"></span>
		<h1 class="mui-center mui-title tc">对阵详情</h1>
	</header>
	<div class="mui-content">
		<table class="tc" width="100%" height="120px">
			<tr>
				<td class="left tc"><img src="img/teamleader.png" width="60px" height="60px" style="border-radius: 50%;" /><br /><span>红队</span></td>
				<td class="score"><span class="f2d0 score1">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="f2d0 score2">0</span></td>
				<td class="right"><img src="img/teamleader.png" width="60px" height="60px" style="border-radius: 50%;" /><br /><span>蓝队</span></td>
			</tr>	
		</table>
		<table class="mt10" width="100%">
			<tr>
				<td width="5%" height="15px"></td>
				<td width="10%" height="15px" style="background-color: #52c0d8;"></td>
				<td width="20%" height="15px" class="tl">&nbsp;已结束</td>
				<td width="10%" height="15px" style="background-color: #c63a3a;"></td>
				<td width="20%" height="15px" class="tl">&nbsp;进行中</td>
				<td width="10%" height="15px" style="background-color: #a6a6a6;"></td>
				<td width="20%" height="15px" class="tl">&nbsp;未开始</td>
				<td width="5%" height="15px"></td>
			</tr>
		</table>
		<div class="matches">
			
		</div>
	<!--	
		<div class="competition mt10 ml5 mr5 pr">
			<img src="img/during.png" width="20px" height="20px" class="pa" style="top:0;right: 0;" />
			<table width="100%" class="pa" style="top:-3px">
				<tr height="40px">
					<td width="40%" class="tr f1d5">7</td>
					<td width="20%" class="tc typebackground">男双</td>
					<td width="40%" class="tl f1d5">5</td>
				</tr>
			</table>
			<hr class="mt20"></hr>
			<div class="competitionInfo mt20">
				<table width="100%">
					<tr>
						<td width="20%" class="tc">
							<img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"><br />林丹
						</td>
						<td width="20%" class="tc">
							<img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"><br />李宗伟
						</td>
						<td width="20%" class="tc">VS</td>
						<td width="20%" class="tc" colspan="2">
							<img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"><br />王仪涵
						</td>
						<td width="20%" class="tc">
							<img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"><br />刘烨
						</td>
					</tr>
					<tr>
						<td width="20%" class="tr" colspan="2">1</td>
						<td width="20%" class="tc">:</td>
						<td width="20%" class="tl" colspan="2">2</td>
					</tr>
					<tr>
						<td width="20%" class="tr" colspan="2">4</td>
						<td width="20%" class="tc">:</td>
						<td width="20%" class="tl" colspan="2">3</td>
					</tr>
					<tr>
						<td width="20%" class="tr" colspan="2">2</td>
						<td width="20%" class="tc">:</td>
						<td width="20%" class="tl" colspan="2">0</td>
					</tr>
				</table>
				<hr class="mt10"></hr>
				<div class="mui-button-row">
					<button type="button" class="mui-btn mui-btn-green" onclick="return false;">观赛</button>&nbsp;&nbsp;
					<button type="button" class="mui-btn mui-btn-danger" onclick="return false;">执裁</button>
				</div>
			</div>
		</div>
		<div class="competition mt10 ml5 mr5 pr">
			<img src="img/over.png" width="20px" height="20px" class="pa" style="top:0;right: 0;" />
			<table width="100%" class="pa" style="top:-3px">
				<tr height="40px">
					<td width="40%" class="tr f1d5">7</td>
					<td width="20%" class="tc typebackground">男单</td>
					<td width="40%" class="tl f1d5">5</td>
				</tr>
			</table>
			<hr class="mt20"></hr>
			<div class="competitionInfo mt20">
				<table width="100%">
					<tr>
						<td width="40%" class="tc oneplayer">
							<a href="#"><img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"></a><br />李宗伟
						</td>
						<td width="20%" class="tc">VS</td>
						<td width="40%" class="tc oneplayer">
							<a href="#"><img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"></a><br />王仪涵
						</td>
					</tr>
					<tr>
						<td width="40%" class="tr">1</td>
						<td width="20%" class="tc">:</td>
						<td width="40%" class="tl">2</td>
					</tr>
					<tr>
						<td width="40%" class="tr">4</td>
						<td width="20%" class="tc">:</td>
						<td width="40%" class="tl">3</td>
					</tr>
					<tr>
						<td width="40%" class="tr">2</td>
						<td width="20%" class="tc">:</td>
						<td width="40%" class="tl">0</td>
					</tr>
				</table>
				<hr class="mt10"></hr>
				<div class="mui-button-row">
					<button type="button" class="mui-btn mui-btn-green" onclick="return false;">观赛</button>&nbsp;&nbsp;
					<button type="button" class="mui-btn mui-btn-danger" onclick="return false;">执裁</button>
				</div>
			</div>
		</div>-->
	</div>
	<script src="js/mui.poppicker.js"></script>
	<script src="js/mui.picker.min.js"></script>
	<script src="js/jquery-1.10.2.min.js"></script>
	<script>
	/*-------------------------------------------初始化单项开始---------------------------------------------*/
		var id_check = "1439286113287,0";
   		var g_UrlBase="http://192.168.199.206:8081";
   		var id = -1;
   		var wholeDetail = [];
   		
   		//获取从首页和创建比赛的页面传来的id号
   		window.addEventListener('myinit',function(event){
			//通过event.detail可获得传递过来的参数内容
			if(id != event.detail.id){
				id = event.detail.id;
				$(".matches").html('');
				//alert(id);
				getResult();
			} else {
				getResult();
			}
		});
    
        function getResult(){
           	var aoData=[];
           	aoData.push( { "name":"id_check","value": id_check} );
           	aoData.push( { "name":"smallSchedule.id", "value": id } );
			doSendAjaxRequest("/actions/SmallSchedule.action?getSmallScheduleDetail",aoData,callbackOne);
        }

        function callbackOne(obj){
           	try{
           		wholeDetail = obj.body;
           		//初始化	
           		var ht = '';
           		if(wholeDetail.team1_url){
           			ht = '<img src="http://banbaisport.oss-cn-beijing.aliyuncs.com/'+wholeDetail.team1_url+'" width="60px" height="60px" style="border-radius: 50%;" /><br /><span>红队</span>';
           			$('.left').html( ht );	
           		}
           		if(wholeDetail.team2_url){
           			ht = '<img src="http://banbaisport.oss-cn-beijing.aliyuncs.com/'+wholeDetail.team2_url+'" width="60px" height="60px" style="border-radius: 50%;" /><br /><span>蓝队</span>';
           			$('.right').html( ht );	
           		}
           		$('.score .score1').text( wholeDetail.score_1 );
           		$('.score .score2').text( wholeDetail.score_2 );
           		/*--------初始化各个match--------*/
           		var typeName = ['男单', '男双', '女单', '女双', '混双'];
           		for(var i = 0; i < wholeDetail.matchList.length; i++){
           			ht = '';
       				ht += '<div class="competition mt10 ml5 mr5 pr">';
					ht += 	'<table width="100%" class="pa" style="top:-3px">';
					ht += 		'<tr height="40px">';
					ht += 			'<td width="40%" class="tr f1d5">'+wholeDetail.matchList[i].score_1+'</td>';
					ht +=			'<td width="20%" class="tc typebackground">'+typeName[parseInt(wholeDetail.matchList[i].competition_type)]+'</td>';
					ht +=			'<td width="40%" class="tl f1d5">'+wholeDetail.matchList[i].score_2+'</td>';
					ht +=		'</tr>';
					ht +=	'</table>';
					ht +=	'<hr class="mt20"></hr>';
					switch (wholeDetail.matchList[i].competition_type)
					{
						case '0':
						case '2':
							ht +=	'<div class="competitionInfo mt20">';
							ht +=		'<img src="img/before.png" width="20px" height="20px" class="pa" style="top:0;right: 0;" />';
							ht +=		'<table width="100%">';
							ht +=			'<tr>';
							ht +=				'<td width="40%" class="tc oneplayer">';
							ht +=					'<a href="#"><img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"></a><br /><span>运动员1</span>';
							ht +=				'</td>';
							ht +=				'<td width="20%" class="tc">VS</td>';
							ht +=				'<td width="40%" class="tc oneplayer">';
							ht +=					'<a href="#"><img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"></a><br /><span>运动员2</span>';
							ht +=				'</td>';
							ht +=			'</tr>';
							ht +=			'<tr>';
							ht +=				'<td width="40%" class="tr">0</td>';
							ht +=				'<td width="20%" class="tc">:</td>';
							ht +=				'<td width="40%" class="tl">0</td>';
							ht +=			'</tr>';
							ht +=			'<tr>';
							ht +=				'<td width="40%" class="tr">0</td>';
							ht +=				'<td width="20%" class="tc">:</td>';
							ht +=				'<td width="40%" class="tl">0</td>';
							ht +=			'</tr>';
							ht +=			'<tr>';
							ht +=				'<td width="40%" class="tr">0</td>';
							ht +=				'<td width="20%" class="tc">:</td>';
							ht +=				'<td width="40%" class="tl">0</td>';
							ht +=			'</tr>';
							ht +=		'</table>';
							ht +=		'<hr class="mt10"></hr>';
							ht +=		'<div class="mui-button-row">';
							ht +=			'<button type="button" class="mui-btn mui-btn-green watch" data-value="">观赛</button>&nbsp;&nbsp;';
							ht +=			'<button type="button" class="mui-btn mui-btn-danger judge" data-value="">执裁</button>';
							ht +=		'</div>';
							ht +=	'</div>';
							break;
						case '1':
						case '3':
						case '4':
							ht +=	'<div class="competitionInfo mt20">';
							ht +=		'<img src="img/before.png" width="20px" height="20px" class="pa" style="top:0;right: 0;" />';
							ht +=		'<table width="100%">';
							ht +=			'<tr>';
							ht +=				'<td width="20%" class="tc oneplayer">';
							ht +=					'<img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"><br />运动员1';
							ht +=				'</td>';
							ht +=				'<td width="20%" class="tc oneplayer">';
							ht +=					'<img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"><br />运动员2';
							ht +=				'</td>';
							ht +=				'<td width="20%" class="tc">VS</td>';
							ht +=				'<td width="20%" class="tc oneplayer" colspan="2">';
							ht +=					'<img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"><br />运动员3';
							ht +=				'</td>';
							ht +=				'<td width="20%" class="tc oneplayer">';
							ht +=					'<img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"><br />运动员4';
							ht +=				'</td>';
							ht +=			'</tr>';
							ht +=			'<tr>';
							ht +=				'<td width="20%" class="tr" colspan="2">0</td>';
							ht +=				'<td width="20%" class="tc">:</td>';
							ht +=				'<td width="20%" class="tl" colspan="2">0</td>';
							ht +=			'</tr>';
							ht +=			'<tr>';
							ht +=				'<td width="20%" class="tr" colspan="2">0</td>';
							ht +=				'<td width="20%" class="tc">:</td>';
							ht +=				'<td width="20%" class="tl" colspan="2">0</td>';
							ht +=			'</tr>';
							ht +=			'<tr>';
							ht +=				'<td width="20%" class="tr" colspan="2">0</td>';
							ht +=				'<td width="20%" class="tc">:</td>';
							ht +=				'<td width="20%" class="tl" colspan="2">0</td>';
							ht +=			'</tr>';
							ht +=		'</table>';
							ht +=		'<hr class="mt10"></hr>';
							ht +=		'<div class="mui-button-row">';
							ht +=			'<button type="button" class="mui-btn mui-btn-green watch"  data-value="">观赛</button>&nbsp;&nbsp;';
							ht +=			'<button type="button" class="mui-btn mui-btn-danger judge" data-value="">执裁</button>';
							ht +=		'</div>';
							ht +=	'</div>';
							break;
						default:
							break;
					}
					ht += '</div>';
					$('.matches').append( ht );	
				}
           	}catch(e){}
        }

        function doSendAjaxRequest(xurl,param,fnCallback){
            if ( xurl.indexOf('http://') == -1 ) xurl = g_UrlBase+xurl;
            $.ajax( {
                "url":  xurl,
                "data": param,
                "timeout" : 10000,
                "contentType" : "application/x-www-form-urlencoded; charset=utf-8",
                "success": function (json) {
                    try{
                        fnCallback( json );
                    }catch(e){}
                },
                "dataType": "json",
                "cache": false,
                "type": "POST",
                "error": function (xhr, error, thrown) {
                }
            } );
        }

        function getUrlParam(xurl,name){
            var para="";
            if(xurl.lastIndexOf("?")>0){
                para=xurl.substring(xurl.lastIndexOf("?")+1,xurl.length);
                var arr=para.split("&");
                para="";
                for(var i=0;i<arr.length;i++){
                   if(arr[i].split("=")[0]==name) return arr[i].split("=")[1];
                }
                return "";
           }else{
                return "";
           }
		}
	/*-------------------------------------------初始化单项结束---------------------------------------------*/
	/*-------------------------------------------创建单项开始-----------------------------------------------*/
		var type = -1;
		(function(m, doc) {
			mui.init({
				preloadPages:[{
			    		id:'selectOnePlayer.html',
			    		url:'selectOnePlayer.html'           
			  	}]
			});
			m.ready(function() {
				//普通示例
				var typePicker = new m.PopPicker();
				typePicker.setData([{
					value: 0,
					text: '男单'
				}, {
					value: 1,
					text: '男双'
				}, {
					value: 2,
					text: '女单'
				}, {
					value: 3,
					text: '女双'
				}, {
					value: 4,
					text: '混双'
				}]);
				var showUserPickerButton = doc.getElementById('createGame');
				//var userResult = doc.getElementById('userResult');
				showUserPickerButton.addEventListener('tap', function(event) {
					// add game
					typePicker.show(function(items) {
						var gameType = JSON.stringify(items[0].value);
						type = gameType;
						var gameTypeName = JSON.stringify(items[0].text);
						var ht = '';
						ht += '<div class="competition mt10 ml5 mr5 pr">';
						ht += 	'<table width="100%" class="pa" style="top:-3px">';
						ht += 		'<tr height="40px">';
						ht += 			'<td width="40%" class="tr f1d5">0</td>';
						ht +=			'<td width="20%" class="tc typebackground">'+gameTypeName+'</td>';
						ht +=			'<td width="40%" class="tl f1d5">0</td>';
						ht +=		'</tr>';
						ht +=	'</table>';
						ht +=	'<hr class="mt20"></hr>';
						switch (gameType)
						{
							case '0':
							case '2':
								ht +=	'<div class="competitionInfo mt20">';
								ht +=		'<img src="img/before.png" width="20px" height="20px" class="pa" style="top:0;right: 0;" />';
								ht +=		'<table width="100%">';
								ht +=			'<tr>';
								ht +=				'<td width="40%" class="tc oneplayer">';
								ht +=					'<a href="#"><img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"></a><br />运动员1';
								ht +=				'</td>';
								ht +=				'<td width="20%" class="tc">VS</td>';
								ht +=				'<td width="40%" class="tc oneplayer">';
								ht +=					'<a href="#"><img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"></a><br />运动员2';
								ht +=				'</td>';
								ht +=			'</tr>';
								ht +=			'<tr>';
								ht +=				'<td width="40%" class="tr">0</td>';
								ht +=				'<td width="20%" class="tc">:</td>';
								ht +=				'<td width="40%" class="tl">0</td>';
								ht +=			'</tr>';
								ht +=			'<tr>';
								ht +=				'<td width="40%" class="tr">0</td>';
								ht +=				'<td width="20%" class="tc">:</td>';
								ht +=				'<td width="40%" class="tl">0</td>';
								ht +=			'</tr>';
								ht +=			'<tr>';
								ht +=				'<td width="40%" class="tr">0</td>';
								ht +=				'<td width="20%" class="tc">:</td>';
								ht +=				'<td width="40%" class="tl">0</td>';
								ht +=			'</tr>';
								ht +=		'</table>';
								ht +=		'<hr class="mt10"></hr>';
								ht +=		'<div class="mui-button-row">';
								ht +=			'<button type="button" class="mui-btn mui-btn-green watch" data-value="">观赛</button>&nbsp;&nbsp;';
								ht +=			'<button type="button" class="mui-btn mui-btn-danger judge" data-value="">执裁</button>';
								ht +=		'</div>';
								ht +=	'</div>';
								break;
							case '1':
							case '3':
							case '4':
								ht +=	'<div class="competitionInfo mt20">';
								ht +=		'<img src="img/before.png" width="20px" height="20px" class="pa" style="top:0;right: 0;" />';
								ht +=		'<table width="100%">';
								ht +=			'<tr>';
								ht +=				'<td width="20%" class="tc oneplayer">';
								ht +=					'<img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"><br />运动员1';
								ht +=				'</td>';
								ht +=				'<td width="20%" class="tc oneplayer">';
								ht +=					'<img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"><br />运动员2';
								ht +=				'</td>';
								ht +=				'<td width="20%" class="tc">VS</td>';
								ht +=				'<td width="20%" class="tc oneplayer" colspan="2">';
								ht +=					'<img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"><br />运动员3';
								ht +=				'</td>';
								ht +=				'<td width="20%" class="tc oneplayer">';
								ht +=					'<img src="img/teamleader.png" width="40px" height="40px" style="border-radius: 50%;"><br />运动员4';
								ht +=				'</td>';
								ht +=			'</tr>';
								ht +=			'<tr>';
								ht +=				'<td width="20%" class="tr" colspan="2">0</td>';
								ht +=				'<td width="20%" class="tc">:</td>';
								ht +=				'<td width="20%" class="tl" colspan="2">0</td>';
								ht +=			'</tr>';
								ht +=			'<tr>';
								ht +=				'<td width="20%" class="tr" colspan="2">0</td>';
								ht +=				'<td width="20%" class="tc">:</td>';
								ht +=				'<td width="20%" class="tl" colspan="2">0</td>';
								ht +=			'</tr>';
								ht +=			'<tr>';
								ht +=				'<td width="20%" class="tr" colspan="2">0</td>';
								ht +=				'<td width="20%" class="tc">:</td>';
								ht +=				'<td width="20%" class="tl" colspan="2">0</td>';
								ht +=			'</tr>';
								ht +=		'</table>';
								ht +=		'<hr class="mt10"></hr>';
								ht +=		'<div class="mui-button-row">';
								ht +=			'<button type="button" class="mui-btn mui-btn-green watch"  data-value="">观赛</button>&nbsp;&nbsp;';
								ht +=			'<button type="button" class="mui-btn mui-btn-danger judge" data-value="">执裁</button>';
								ht +=		'</div>';
								ht +=	'</div>';
								break;
							default:
								break;
						}
						ht += '</div>';
						$('.matches').append( ht );
						// 创建单项
						createMatch();
					});
				}, false);
			});
		})(mui, document);
		/*-------------------------------------------创建单项结束-----------------------------------------------*/
		/*---------------------------------------创建单项提交数据开始--------------------------------------------*/
		var matchIds = [];
		function createMatch(){
           	var aoData=[];
           	aoData.push( { "name":"id_check",			"value": id_check} );
           	aoData.push( { "name":"smallSchedule.id", 	"value": id } );
           	aoData.push( { "name":"type",				"value": type } );
			doSendAjaxRequest("/actions/SmallSchedule.action?insertSmallScheduleMatch",aoData,callbackForCreateMatch);
        }
        function callbackForCreateMatch(obj){
           	try{
           		matchIds.push( obj.msg );
           		alert(obj.msg);
           	}catch(e){}
        }
		/*---------------------------------------创建单项提交数据开始--------------------------------------------*/
		/*----------------------------------向选择上场运动员页面发送数据开始--------------------------------------*/
		$(document).on("click", ".oneplayer a", function(e){
			var detailPage = null;
		  	if(!detailPage){
		    		detailPage = plus.webview.getWebviewById('selectOnePlayer.html');
		  	}
		  	mui.fire(detailPage,'selectedPlayer',{
		  		wholeDetail: wholeDetail
		  	});
			mui.openWindow({ id:"selectOnePlayer.html", url:"selectOnePlayer.html"});
		});
		/*----------------------------------向选择上场运动员页面发送数据结束--------------------------------------*/	
		/*-------------------------------------------页面链接切换-----------------------------------------------*/
		mui(".oneplayer").on('tap', 'a', function(e){
			mui.openWindow({ id:"selectOnePlayer.html", url:"selectOnePlayer.html"});
		});
		mui("header").on("tap", 'a', function(e){
			mui.openWindow({ 
				id:"index.html", 
				url:"index.html",
				createNew:false,
				show: {
					aniShow: 'slide-in-left',
					uration: 200
                },
                waiting: {
                    autoShow: true, //自动显示等待框
                    title: '正在加载...', //等待对话框上显示的提示内容
                }
			});
		});
	</script>
</body>
</html>