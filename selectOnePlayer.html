<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
  	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
		
    <script src="js/mui.min.js"></script>
    <link href="css/mui.min.css" rel="stylesheet"/>
    <link href="css/base.css" rel="stylesheet"/>
    <!--
    <script type="text/javascript" charset="utf-8">
      	mui.init();
    </script>-->
    <style>
    		* {color: #323a45;}
    		header.mui-bar.mui-bar-nav {background-color: #18b4ed;}
    		header.mui-bar.mui-bar-nav a{color:#fff;}
    		header.mui-bar.mui-bar-nav span{color:#fff; height:1.6em}
    		header.mui-bar.mui-bar-nav h1 {color:#fff;}
    		header {
    			box-shadow: none;
    			-webkit-box-shadow:none;
    		}
    </style>
</head>
<body>
	<header class="mui-navbar-inner mui-bar mui-bar-nav">
		<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left" href="createMinorTournamentNew.html"></a>
		<h1 class="mui-center mui-title tc">选择上场队员</h1>
	</header>
	<div class="mui-content">
		<div class="p20 headimgs"><!--
			<table width="100%">
				<tr class="pt10 tc" height="120px">
					<td id="addplayer" width="25%">
						<a href="#"><img src="img/addplayer.png" width="65px" height="65px"/></a><br />&nbsp;
					</td>
					<td width="25%" class="pr">
						<img src="img/teamleader.png" width="65px" height="65px" class="headimg selected" /><br /><span>马天宇</span>
						<img src="img/playerselected.png" width="15px" height="15px" class="pa" style="top:15px; right: 10px;"/>
					</td>
					<td width="25%" class="pr">
						<img src="img/teamleader.png" width="65px" height="65px" class="headimg" /><br /><span>马景涛</span>
					</td>
					<td width="25%" class="pr">
						<img src="img/teamleader.png" width="65px" height="65px" class="headimg" /><br /><span>呵呵哒</span>
					</td>
				</tr>
				<tr class="pt10 tc" height="120px">
					<td width="25%" class="pr"><img src="img/teamleader.png" width="65px" height="65px" class="headimg"/><br /><span>黄勇刘</span></td>
					<td width="25%" class="pr"><img src="img/teamleader.png" width="65px" height="65px" class="headimg"/><br /><span>马天宇</span></td>
					<td width="25%" class="pr"><img src="img/teamleader.png" width="65px" height="65px" class="headimg"/><br /><span>马景涛</span></td>
					<td width="25%" class="pr"><img src="img/teamleader.png" width="65px" height="65px" class="headimg"/><br /><span>呵呵哒</span></td>
				</tr>
			</table>-->
		</div>
		<div id="seed"><button>种子选手</button></div>
	</div>
	<script src="js/jquery-1.10.2.min.js"></script>
	<script>
		mui.init({
		  	preloadPages:[{
		    		id:'selectMoreFriends.html',
		    		url:'selectMoreFriends.html'           
			}]
		});
		/*------------------------------------------------添加队友开始----------------------------------------------*/
		
		/*------------------------------------------------添加队友结束----------------------------------------------*/
		/*------------------------------------------------选择队员开始----------------------------------------------*/
		$(document).on('click', '.headimg', function(){
			if(!$(this).hasClass("selected")){
				$(".selected").each(function(index, element){
					$($(this).parent().find("img")[1]).remove();
					$(this).removeClass("selected");
				});
				$(this).parent().append('<img src="img/playerselected.png" width="15px" height="15px" class="pa" style="top:15px; right: 10px;"/>');
				$(this).addClass("selected");
			} else {
				$($(this).parent().find("img")[1]).remove();
				$(this).removeClass("selected");
			}
		});
		/*------------------------------------------------选择队员结束----------------------------------------------*/
		/*------------------------------------------------统计选择开始----------------------------------------------*/
		/*
		mui('.mui-indexed-list-inner').on('change', 'input', function() {
			var count = list.querySelectorAll('input[type="checkbox"]:checked').length;
			var value = count ? "完成(" + count + ")" : "完成";
			done.innerHTML = value;
			if (count) {
				if (done.classList.contains("mui-disabled")) {
					done.classList.remove("mui-disabled");
				}
			} else {
				if (!done.classList.contains("mui-disabled")) {
					done.classList.add("mui-disabled");
				}
			}
		});
		/*------------------------------------------------统计选择结束----------------------------------------------*/
		/*---------------------------自定义事件1——接收competitionDetail.html数据开始--------------------------------*/
		var playersInfo = [];
		window.addEventListener('selectedPlayer',function(event){
			//通过event.detail可获得传递过来的参数内容
			if(playersInfo.length != 0) playersInfo.length = 0; 
			for(var i = 0; i < event.detail.playersInfo.length; i++){
				playersInfo.push(event.detail.playersInfo[i]);
			}
			//初始化头像
			var total = playersInfo.length + 1;
			var num = (playersInfo.length + 1)/4;
			var i = 0;
			var index = 0;
			
			var ht = '';
			ht +=	'<table width="100%">';
			for(; i < num; i++){
				ht +=	'<tr class="pt10 tc" height="120px">';
				for(var j = 0; j < 4; j++, index++){
					if(index == 0){
						ht += '<td id="addplayer" width="25%"><a href="#"><img src="img/addplayer.png" width="65px" height="65px"/></a><br />&nbsp;</td>';
					} else {
						ht += '<td width="25%" class="pr">';
						if(index < total){
							ht +=	'<img src="http://banbaisport.oss-cn-beijing.aliyuncs.com/'+playersInfo[index-1].img_url+'" width="65px" height="65px" class="headimg" style="border-radius:50%"/><br />';
							ht +=	'<span data-value="'+playersInfo[index-1].player_id+'">'+playersInfo[index-1].player_name+'</span>';
						}
						ht += '</td>';
					}
				}
				ht += '</tr>';
			}
			ht += '</table>';
			$(".headimgs").html( ht );
		});
		/*---------------------------自定义事件1——接收competitionDetail.html数据结束--------------------------------*/
		/*-----------------------------向selectMoreFriends.html发送已有好友数据开始---------------------------------*/
		$(document).on('click', '#addplayer a',function(){
			var detailPage = null;
		  	//获得详情页面
		  	if(!detailPage){
		    		detailPage = plus.webview.getWebviewById('selectMoreFriends.html');
		  	}
		  	//触发详情页面的newsId事件
		  	mui.fire(detailPage,'selectedFriends',{
		    		playersInfo:playersInfo
		  	});
			mui.openWindow({ id:"selectMoreFriends.html", url:"selectMoreFriends.html"});
		});
		/*-----------------------------向selectMoreFriends.html发送已有好友数据结束---------------------------------*/
		/*---------------------------自定义事件2——接收selectMoreFriends.html数据开始--------------------------------*/
		var multiFriendsId = [];
		var multiFriendsName = [];
		window.addEventListener('selectMoreFriends',function(event){
			//通过event.detail可获得传递过来的参数内容
			if(multiFriendsId.length != 0) multiFriendsId.length = 0;
			if(multiFriendsName.length != 0) multiFriendsName.length = 0;
			for(var i = 0; i < event.detail.id.length; i++){
				multiFriendsId.push(event.detail.id[i]);
				multiFriendsName.push(event.detail.name[i]);
			}
			//alert(multiFriendsId.join());
			//alert(multiFriendsName.join());
		});
		/*---------------------------自定义事件1——接收selectMoreFriends.html数据结束--------------------------------*/
		/*--------------------------------------------------页面链接------------------------------------------------*/
		mui("#seed").on('tap', 'button', function(e){
			mui.openWindow({ id:"singlesRound.html", url:"singlesRound.html"});
		});
	</script>
</body>
</html>